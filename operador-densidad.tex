\subsection*{Ejercicio 26: probar el siguiente teorema}

\begin{myblock}{Teorema 8.22}
	Para todo operador densidad $\rho$ se tiene $tr(\rho^2) \leq 1$. Además, la igualdad se cumple si y solo si $\rho$ está en un estado puro.
\end{myblock}

\def\ij{| i \rangle \langle i | j \rangle \langle j |}

Recordemos que para un conjunto de estados puros $\{(p_i, | \psi_i \rangle)\}$, el operador de densidad es $\rho = \sum_i p_i | \psi_i \rangle \langle \psi_i |$.
Por el Teorema 8.25 del apunte se tiene que puede ser escrito como $\rho = \sum_j \lambda_j | j \rangle \langle j |$ donde los $|j\rangle$ son ortonormales y $\lambda_j \in \mathbb{R}_0^+$. Vemos entonces que:

\[
	tr(\rho^2) = tr \left(\left(\sum_i \lambda_i |i\rangle \langle i|\right)^2\right) = tr\left(\sum_i \sum_j \lambda_i \lambda_j \ij\right) = \sum_i \sum_j \lambda_i \lambda_j tr(\ij)
\]

Como los vectores son ortonormales, tenemos que $\langle i | j \rangle = \delta_{ij}$, entonces:

\[
	\sum_i \sum_j \lambda_i \lambda_j tr(\ij) = \sum_i \sum_j \delta_{ij} \lambda_i \lambda_j tr(|i\rangle \langle j|) = \sum_i \lambda_i^2 tr(|i\rangle\langle i|)
\]

Luego, por el Teorema 8.12 del apunte, $tr(|i\rangle \langle i |) = \langle i | i \rangle = 1$, por lo que $tr(\rho^2) = \sum_i \lambda_i^2$.

Además es sabido que:

\[
	tr(\rho) = tr\left(\sum_i \lambda_i | i \rangle \langle i |\right) = \sum_i \lambda_i = 1
\]

Como los $\lambda_i$ son positivos, se tiene que $0 \leq \lambda_i \leq 1$ para todo $i$, por lo tanto $\lambda_i^2 \leq \lambda_i$. Luego:

$$tr(\rho^2) = \sum_i \lambda_i^2 \leq \sum_i \lambda_i = tr(\rho) = 1$$

En el caso en el que $\rho$ está en estado puro, se puede escribir como $|\psi\rangle \langle\psi|$, y es fácil ver que $tr(\rho^2)=tr(|\psi\rangle\langle\psi|\psi\rangle\langle\psi|)=tr(|\psi\rangle\langle\psi|)=\langle\psi|\psi\rangle=1$.

Cuando $\rho$ es un estado mixto, no puede ser escrito de esa forma, por lo que por lo menos dos $\lambda_i$ son no nulos, esto junto con que $\sum_i \lambda_i = 1$ y $0 \leq \lambda_i \leq 1$, fuerza a que $\lambda_i < 1$ para todo $i$. Por lo tanto $\lambda_i^2 < \lambda_i$ y entonces

\[
	tr(\rho^2) = \sum_i \lambda_i^2 < \sum_i \lambda_i = 1
\]
